<h5 style="text-align: center;">Серверы</h5>
<p-toast></p-toast>
<p-toolbar>
  <ng-template pTemplate="left">
    <button pButton pRipple label="Новый сервер" icon="pi pi-plus" class="p-button-success" (click)="addServer()" ></button>
  </ng-template>
</p-toolbar>
<style>
  input.largerCheckbox {
    width: 18px;
    height: 15px;
  }
</style>
  <p-table
    styleClass="p-datatable-gridlines"
    [resizableColumns]="true"
    [columns]="colsServer"
    [value]="Servers"
    sortMode="multiple"
    [scrollable]="true"
    selectionMode="single"
    [paginator]="true"
    [rows]="10" [pageLinks]="3" [rowsPerPageOptions]="[5,10,20,1000]"
    currentPageReportTemplate="Демонстрация от {first} до {last} из {totalRecords} записи(ей)" [showCurrentPageReport]="true"
    [(selection)]="selectItem">
    <ng-template pTemplate="header" let-columns >
      <tr>
        <th pResizableColumn ></th>
        <th *ngFor="let col of columns" [pSortableColumn]="col.field" pResizableColumn >
          {{col.header}}
          <p-sortIcon [field]="col.field"></p-sortIcon>
        </th>
        <th pResizableColumn ></th>
      </tr>

      <tr>
        <th pResizableColumn >
          <p-tableHeaderCheckbox> </p-tableHeaderCheckbox>
        </th>
        <th *ngFor="let col of columns" pResizableColumn >
          <p-columnFilter type="text" [field]="col.field" [matchMode]="'contains'"></p-columnFilter>
        </th>
        <th pResizableColumn ></th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-rowData let-columns="columns" >
      <tr [pEditableRow]="rowData" >

        <td pResizableColumn >
          <p-tableCheckbox [value]="columns" ></p-tableCheckbox>
        </td>
        <td>{{rowData?.servers?.dns_name}}</td>
        <td>{{rowData?.model_name}}</td>
        <td>{{rowData?.serial_num}}</td>
        <td>{{rowData?.inventory_num}}</td>
        <td>{{rowData?.processor_quantity}}</td>            
        <td>{{rowData?.total_cores_quantity}}</td>
        <td>{{rowData?.total_threads_quantity}}</td>
        <td>{{rowData?.total_ram_size}}</td>
        <td>{{rowData?.dns_name}}</td>
        <td>{{rowData?.dns_domain}}</td>
        <td>{{rowData?.ip_adresses}}</td>
        <td>{{rowData?.management_ip_adresses}}</td>
        <td>{{rowData?.rack_height}}</td>
        <td>{{rowData?.system_name}}</td>
        <td>{{rowData?.system_license}}</td>
        <td>{{rowData?.system_need_to_license}}</td>
        <td>{{rowData?.my_notes}}</td>
        <td>{{rowData?.id}}</td>
        <td pResizableColumn >
            <button pButton pRipple icon="pi pi-trash"
                    class="p-button-rounded p-button-warning"
                    type="button"
                    (click)="deleteServer(rowData.id)">
            </button>
            <button pButton pRipple icon="pi pi-pencil"
                    class="p-button-rounded p-button-help"
                    type="button"
                    (click)="editServer(rowData)">
            </button>
        </td>
      </tr>
    </ng-template>
  </p-table>

<p-dialog [(visible)]="ServerDialog" [style]="{width: '800px'}" header="Новый сервер" [modal]="true" styleClass="p-fluid">
  
  <ng-template pTemplate="content" >
    <div class="p-formgrid p-grid">
      <div class="row">
        <div class="col-sm">

<div class="dropdown">
  <label> Хост ID (только для виртуальных серверов)</label>
    <ng-select  [items]="hostServers"
                bindLabel="dns_name"
                placeholder="выбор* (DNS имя)"
                bindValue="id"  
                [selectOnTab]="true"
                [(ngModel)]="server.host_server_id" ></ng-select>     
</div>
<div class="p-field">
  <label>Наименование модели</label>
  <input type="text" pInputText  [(ngModel)]="server.model_name"  placeholder="текст"/>
</div>
<div class="form-group" [hidden]="server.host_server_id" style="margin-top: 10px; margin-right: 10px;"  >
  <div class="row">
    <label for="server.serial_num" class="col control-label" >Серийный номеp</label>
    <input type="text"  [(ngModel)]="server.serial_num" placeholder="число"
     class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" [hidden]="server.host_server_id" style="margin-top: 5px; margin-right: 10px;"  >
  <div class="row">
    <label for="server.inventory_num" class="col control-label">Инвентарный номер</label>
    <input type="text" [(ngModel)]="server.inventory_num" placeholder="число" 
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" [hidden]="server.host_server_id" style="margin-top: 5px; margin-right: 10px;"  >
  <div class="row">
    <label for="server.rack_height" class="col control-label">Высота сервера (Unit)</label>
    <input type="text" [(ngModel)]="server.rack_height" placeholder="число" 
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" style="margin-top: 5px; margin-right: 10px;">
  <div class="row">
    <label for="server.processor_quantity" class="col control-label">Частота процессора (Ггц)</label>
    <input type="text" [(ngModel)]="server.processor_quantity" placeholder="число" 
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" style="margin-top: 5px; margin-right: 10px;">
  <div class="row">
    <label for="server.total_cores_quantity" class="col control-label">Количество ядер</label>
    <input type="text" [(ngModel)]="server.total_cores_quantity" placeholder="число"
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" style="margin-top: 5px; margin-right: 10px;">
  <div class="row">
    <label for="server.total_threads_quantity" class="col control-label">Количество потоков</label>
    <input type="text" [(ngModel)]="server.total_threads_quantity" placeholder="число" 
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
<div class="form-group" style="margin-top: 5px; margin-right: 10px;">
  <div class="row">
    <label for="server.total_ram_size" class="col control-label">RAM (ГБ)</label>
    <input type="text" [(ngModel)]="server.total_ram_size" placeholder="число" 
    class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
  </div>
</div>
  </div>
  <div class="col-sm">
<div class="p-field">
  <label>DNS имя</label>
  <input type="text" pInputText  [(ngModel)]="server.dns_name"  placeholder="текст"/>
</div>
<div class="p-field">
  <label>DNS домен</label>
  <input type="text"  pInputText  [(ngModel)]="server.dns_domain" placeholder="текст" />
</div>
<div class="p-field">
  <label>IP адрес</label>
  <input type="text"  pInputText  [(ngModel)]="server.ip_adresses"  placeholder="текст" 
  required pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"/>
</div>
<div class="p-field">
  <label>Управляющий IP адрес</label>
  <input type="text"  pInputText  [(ngModel)]="server.management_ip_adresses" placeholder="текст"
  required pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"/>
</div>
<div class="p-field">
  <label>Название ОС</label>
  <input type="text" pInputText  [(ngModel)]="server.system_name" placeholder="текст" />
</div>
<div class="p-field">
  <label>Лицензия ОС</label>
  <input type="text"  pInputText  [(ngModel)]="server.system_license" placeholder="текст" />
</div>
<div class="p-field-checkbox">
  <label>ОС требует лицензирования</label>
  <input type="checkbox" class="largerCheckbox" [(ngModel)]="server.system_need_to_license"  />
</div>
    </div>
  </div>
</div>
<div class="p-field">
  <label>Заметки</label>
  <input type="text" pInputText  [(ngModel)]="server.my_notes" placeholder="текст"  />
</div>
  </ng-template>

  <ng-template pTemplate="footer">
    <div class="row">
      <div class="col-6"> 
        <button pButton pRipple type="submit" label="Сохранить" icon="pi pi-check" class="p-button-text" (click)="saveServer()" ></button> 
      </div>
      <div class="col-6"> 
        <button pButton pRipple label="Отмена" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button> 
      </div>
    </div>
  </ng-template>
</p-dialog>

<p-confirmDialog ></p-confirmDialog>
