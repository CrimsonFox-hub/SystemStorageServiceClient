<h5 style="text-align: center;">Массивы</h5>
<p-toast></p-toast>
<p-toolbar styleClass="p-mb-2">
  <ng-template pTemplate="left">
    <button pButton pRipple label="Новый массив" icon="pi pi-plus" class="p-button-success" (click)="addStorage()" ></button>
  </ng-template>
</p-toolbar>

<p-table
  styleClass="p-datatable-gridlines"
  [resizableColumns]="true"
  [columns]="colsStorage"
  [value]="Storages"
  sortMode="multiple"
  [scrollable]="true"
  selectionMode="single"
  [metaKeySelection]="true"
  [paginator]="true"
  [rows]="10" [pageLinks]="3" [rowsPerPageOptions]="[5,10,20,1000]"
  currentPageReportTemplate="Демонстрация от {first} до {last} из {totalRecords} записи(ей)" [showCurrentPageReport]="true"
  [(selection)]="selectItem"
>
  <ng-template pTemplate="header" let-columns  style="margin-right: 0;">
    <tr>
      <th pResizableColumn ></th>
      <th *ngFor="let col of columns" [pSortableColumn]="col.field" pResizableColumn>
        {{col.header}}
        <p-sortIcon [field]="col.field"></p-sortIcon>
      </th>
      <th pResizableColumn ></th>
    </tr>
    <tr>
      <th pResizableColumn >
        <p-tableHeaderCheckbox> </p-tableHeaderCheckbox>
      </th>
      <th *ngFor="let col of columns" pResizableColumn>
        <p-columnFilter type="text" [field]="col.field" [matchMode]="'contains'"></p-columnFilter>
      </th>
      <th pResizableColumn ></th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-rowData let-columns="columns"  let-colum>
    <tr [pEditableRow]="rowData" >
      <td pResizableColumn >
      <p-tableCheckbox [value]="colum"></p-tableCheckbox>
      </td>
      <ng-container  *ngFor="let col of columns">
        <td pResizableColumn >
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText type="text" [(ngModel)]="rowData[col.field]" required />
            </ng-template>
            <ng-template pTemplate="output">
              {{ rowData[col.field] }}
            </ng-template>
          </p-cellEditor>
        </td>
      </ng-container>

      <td pResizableColumn >
        <button pButton pRipple icon="pi pi-trash"
                class="p-button-rounded p-button-warning"
                type="button"
                (click)="deleteStorage(rowData.id)">
        </button>
        <button pButton pRipple icon="pi pi-pencil"
                class="p-button-rounded p-button-help"
                type="button"
                (click)="editStorage(rowData)">
        </button>
      </td>

    </tr>
  </ng-template>
</p-table>

<p-dialog [(visible)]="StorageDialog" [style]="{width: '800px'}" header="Новый массив" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content" >
  <div class="p-formgrid p-grid">
    <div class="row">
      <div class="col-sm">
  
  <div class="p-field">
    <label>Наименование модели</label>
    <input type="text" pInputText [(ngModel)]="storage.model_name"  placeholder="текст"/>
  </div>
  <div class="p-field">
    <label>DNS имя</label>
    <input type="text" pInputText  [(ngModel)]="storage.dns_name" placeholder="текст" />
  </div>
  <div class="p-field">
    <label>DNS домен</label>
    <input type="text"  pInputText  [(ngModel)]="storage.dns_domain" placeholder="текст"  />
  </div>
  <div class="p-field">
    <label>IP адрес</label>
    <input type="text"  pInputText  [(ngModel)]="storage.ip_adresses" placeholder="текст" 
    required pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"/>
  </div>
  <div class="p-field">
    <label>Управляющий IP адрес</label>
    <input type="text"  pInputText  [(ngModel)]="storage.management_ip_adresses" placeholder="текст" 
    required pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"/>
  </div>

</div>
<div class="col-sm">

  <div class="form-group"  style="margin-top: 5px; margin-right: 10px;"  >
    <div class="row">
      <label for="storage.serial_num" class="col control-label">Серийный номер</label>
      <input type="text" [(ngModel)]="storage.serial_num" placeholder="число" 
      class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
    </div>
  </div>
  <div class="form-group"  style="margin-top: 5px; margin-right: 10px;"  >
    <div class="row">
      <label for="storage.inventory_num" class="col control-label">Инвентарный номер</label>
     <input type="text" [(ngModel)]="storage.inventory_num" placeholder="число" 
     class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
    </div>
  </div>
  <div class="form-group" style="margin-top: 5px; margin-right: 10px;"  >
    <div class="row">
      <label for="storage.rack_height" class="col control-label">Высота массива (Unit)</label>
      <input type="text" [(ngModel)]="storage.rack_height" placeholder="число" 
      class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
    </div>
  </div>
  <div class="form-group" style="margin-top: 5px; margin-right: 10px;"  >
    <div class="row">
      <label for="storage.total_size" class="col control-label">Размер</label>
      <input type="text" [(ngModel)]="storage.total_size" placeholder="число" 
      class="col control-label rounded border border-1" (keypress)="onKeyPress($event)"/>
    </div>
  </div>
  <div class="p-field">
    <label>Тип соединения</label>
    <input type="text" pInputText  [(ngModel)]="storage.connection_type" placeholder="текст" />
  </div>

    </div>
  </div>
</div>
<div class="p-field">
  <label>Заметки</label>
  <input type="text" pInputText  [(ngModel)]="storage.my_notes" placeholder="текст"  />
</div>
</ng-template>

<ng-template pTemplate="footer">
  <div class="row">
    <div class="col-6"> 
      <button pButton pRipple type="submit" label="Сохранить" icon="pi pi-check" class="p-button-text" (click)="saveStorage()" ></button> 
    </div>
    <div class="col-6">
       <button pButton pRipple label="Отмена" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button> 
    </div>
  </div>
</ng-template>
</p-dialog>

<p-confirmDialog></p-confirmDialog>
